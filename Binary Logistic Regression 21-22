import pandas as pd
import numpy as np
import statsmodels.api as sm

df = pd.read_excel('Student grades 2021_2022.xlsx', 
                   dtype = {"Gender": str,
                            "Grade": float})
Gender = df["Gender"]
Grade = df['Final Grade']

GenderNP = Gender.to_numpy(dtype=None, copy=False)
GradeVar = Grade.to_numpy(dtype=None, copy=False)

males = 0 
females = 0 

GenderVar = np.zeros(GenderNP.size)
for i in range(GenderNP.size):
  if GenderNP[i] == 'M':
    GenderVar[i] = int(0)
    males = males + 1
  elif GenderNP[i] == 'F':
    GenderVar[i] = int(1)
    females = females + 1 

print('The number of males in the dataset is:',males)
print('The number of females in the dataset is:',females)

# building the model and fitting the data
log_reg = sm.Logit(GenderVar, GradeVar).fit()

# printing the summary table
print(log_reg.summary())
 
# performing predictions on the test dataset
yhat = log_reg.predict(GradeVar)
prediction = list(map(round, yhat))
 
# comparing original and predicted values of gender
print('Actual values', list(GenderVar))
print('Predictions :', prediction)

# prediction per possible grade
X_test = [1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10]
y_pred=log_reg.predict(X_test)
print('Possible grades:',X_test)
print('Corresponding probability:',y_pred)
